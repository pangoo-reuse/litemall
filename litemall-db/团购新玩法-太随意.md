# 太随意
* 定义：不同于以往的团购定义3人5人成团的购买规则。
    超级团购则定义最低单价跟产品拼团活动时间，
    在单价跟活动时间内买家可邀请转发任意用户直至到达最低价或到达活动结束时间。
## 设计思路
 * 设计思路 
    
    后端定义一张表，关联已发布的商品。当越来越多的用户参与购买，系统
    
    
        public static void main(String args[]) {
            c(1, 30.0, 16.0, 300);
        }
        private static void c(int weight, double originPrice, double minPrice, int maxWeight) {
        //价格:30 ,总份数:300
        
        // 首先每个用户只允许下一单,不然不好计算。后期可允许用户多下几单
        // 300 jin 卖给 x 个人，每个人买(x * y )斤 ，直到单价大于等于最低价。
        // 本来你要拿着30元去进一斤，这个时候原价为16，也就是说你一份你赚14元。
        // 而这个时候你把14元不赚了，平均分配给了300份，所以这个时候价格就低于30.
        // 也就是说用户的30可以买30多元钱的货，也是就是货物不止最初的一份了。肯定比一份多。
        // 你就必须拿出你赚的14元再多进一些货发给用户。这个时候你就赚不到14了。当再有用户购买，你又让出他的那份利润14元。分担到这原本300个订单上，这原本就不止一份的现在又多了一点，
        // 你又要拿出上次的14元剩下的跟这次的14元再去躲进一些分配给这两个用户。依此类推，你每单的利润就会递减。
        // 同时用户的单价就递减，也就是同样的钱可以买更多的东西了
        
        // 但总体来讲，每单的利润低了，但单数多了你的利润也起来了。同样用户同样的价格买了更多的东西。互利共赢的

        double currentPrice = originPrice - (originPrice- minPrice)/maxWeight *weight;
        System.out.println("购买人数:"+weight);
        System.out.println("当前单价:"+currentPrice);
        System.out.println("每人得到多少份:"+originPrice/currentPrice);
        if (currentPrice - minPrice >0) {
            weight++;
            c(weight, originPrice, minPrice, maxWeight);

        }
    }
    
    P购商品必须单独生成一个订单，单独发货。方便备货跟结算
    
    -- p2p_rules 表
    
    --     `id`             int(11) NOT NULL AUTO_INCREMENT,
    --     `goods_id` int(11) COMMENT '商品ID',
    --     `max_person_count` int(11) COMMENT '最大限制人数',
    --     `goods_count` int(11) COMMENT 'p购商品基础总数量',
    --     `goods_name` varchar(128) COMMENT '商品名',
    --     `pic_url`     varchar(255) COMMENT 'p2p购买封面',
    --     `state`   int(1)  NOT NULL DEFAULT '0' COMMENT '状态: 1 线上， 0 下线',
    --     `product_rule`   int(1)  NOT NULL DEFAULT '0' COMMENT '产品规则： 1 固定总份数 2 固定总人数',
    --     `shipping_rule`   int(1)  NOT NULL DEFAULT '0' COMMENT '发货规则： 1 退多余款，2 按每人得到的份数发货',
    --     `created_time`   datetime         DEFAULT NULL COMMENT '创建时间',
    --     `update_time`    datetime         DEFAULT NULL COMMENT '更新时间',
    --     `deleted`        tinyint(1)       DEFAULT '0' COMMENT '逻辑删除',
    
    -- p2p_orders 表
    
    --     `id`             int(11) NOT NULL AUTO_INCREMENT,
    --     `order_id` int(11) COMMENT '订单ID',
    --     `shipping_rule_id` int(11) COMMENT 'P购活动ID',
    --     `user_id` int(11) COMMENT '用户ID',
    --     `order_price`     decimal(10,2) DEFAULT '0.00' COMMENT '下单价格',
    --     `current_goods_peice`   decimal(10,2) DEFAULT '0.00' COMMENT '当前P购商品价格(活动未结束此价格=order_price)',
    --     `state`   int(1)  NOT NULL DEFAULT '0' COMMENT '当前状态： 1 已退款 0 未退款 p2p_rules.shipping_rule == 1 时有效  ',
    --     `created_time`   datetime         DEFAULT NULL COMMENT '创建时间',
    --     `update_time`    datetime         DEFAULT NULL COMMENT '更新时间',
    --     `deleted`        tinyint(1)       DEFAULT '0' COMMENT '逻辑删除',
    
    